---
layout: post
title: "프로세스에 대한 연산"
categories: [OS]
comments: true
tags:
  - OS
  - Process
---

## 프로세스에 대한 연산
#### 프로세스 생성 
프로세스는 실행 도중에 여러 개의 새로운 프로세스들을 생성할 수 있다. 생성 과정을 반복해 프로세스의 트리가 형성된다. 

운영체제는 유일한 프로세스 **식별자**(pid)로 프로세스를 구분한다. 

부모 프로세스: 생성하는 프로세스 
자식 프로세스: 새로운 프로세스 
- 자식 프로세스는 운영체제로부터 직접 자원을 얻거나 부모 프로세스 자원의 일부를 사용
    - 자식 프로세스가 부모 프로세스 자원의 일부분만을 사용하도록 제한하면, 어떤 프로세스가 너무 많은 서브프로세스들을 만들어 시스템을 과부하 상태로 만드는 것을 방지할 수 있음 
- 부모 프로세스는 자원을 분할해 자식들에게 나누어주거나 여러 자식들과 일부 자원(메모리, 파일 등)을 공유 
- 프로세스가 생성될 때 초기화 자료(파일명, 터미널 장치 등)가 부모에서 자식 프로세스로 전달될 수 있다. 

프로세스가 새로운 프로세스를 생성할 때 실행 가능성
- 부모가 계속해서 자식과 병렬로 실행됨
- 부모가 모든 자식 또는 일부 자식이 끝날 때까지 기다림

새로운 프로세스들의 주소 공간 측면에 대한 가능성
- 자식 프로세스는 부모 프로세스의 복사본(똑같은 프로그램과 데이터를 가짐)
- 자식 프로세스가 자신에게 적재될 새로운 프로그램을 가짐 

![process creation](process-creation.jpeg)

fork(): 새로운 프로세스 생성 
- 새로운 프로세스는 원래 프로세스의 주소 공간의 복사본으로 구성됨 -> 통신 가능

exec(): fork() 이후 두 프로세스 중 하나가 자신의 메모리 공간을 새로운 프로그램으로 바꿈
- 이진 파일을 메모리로 적재(load)하고(원 프로그램의 메모리 이미지는 파괴) 적재된 프로그램을 실행 

wait(): 자식이 끝날 때까지 기다림
    - 준비완료 큐에서 부모 프로세스를 제거함

exit(): 프로세스 종료 

#### 프로세스 종료 
프로세스가 실행을 모두 끝내고, `exit()`을 사용해 운영체제에게 자신의 제거를 요청하면 프로세스는 종료한다. 
프로세스는 자신의 부모 프로세스에게 상태 값을 반환할 수 있다. 
물리 메모리, 가상 메모리, 열린 파일, 입출력 버퍼를 포함한 프로세스의 모든 자원이 운영체제로 반납된다. 

exit()을 사용하지 않고 부모 프로세스가 `TerminateProcess()`를 통해 자식 프로세스를 종료시킬 수도 있다. 

자식 프로세스의 종료 요인
- 자식이 할당된 자원을 초과해 사용할 때
- 자식에게 할당된 태스크(task)가 더 이상 필요 없을 때
- 부모가 exit하는데, 운영체제는 부모가 exit한 후에 자식이 실행을 계속하는 것을 허용하지 않는 경우 

